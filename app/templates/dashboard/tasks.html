{% extends "base.html" %}

{% block title %}Tasks — TaskFlow{% endblock %}
{% block header_title %}Tasks{% endblock %}
{% block page_title %}Your Tasks{% endblock %}
{% block page_subtitle %}Manage and track all your tasks in one place{% endblock %}

{% block content %}

<div class="flex justify-end mb-6">
  <a href="{{ url_for('dashboard.task_create') }}"
     class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm shadow">
    + New Task
  </a>
</div>

<div class="bg-white dark:bg-slate-800 border dark:border-slate-700 rounded-xl shadow-sm">
  <table class="w-full text-left text-sm">
    <thead class="border-b dark:border-slate-700">
      <tr>
        <th class="py-3 px-4 text-slate-600 dark:text-slate-400">Title</th>
        <th class="py-3 px-4 text-slate-600 dark:text-slate-400">Project</th>
        <th class="py-3 px-4 text-slate-600 dark:text-slate-400">Status</th>
        <th class="py-3 px-4 text-slate-600 dark:text-slate-400">Due</th>
        <th class="py-3 px-4"></th>
      </tr>
    </thead>

    <tbody class="divide-y dark:divide-slate-700">
      {% for task in tasks %}
      <tr class="hover:bg-slate-50 dark:hover:bg-slate-700/30 transition">
        
        <td class="py-3 px-4 font-medium text-slate-800 dark:text-slate-200">
          {{ task.title }}
        </td>

        <td class="py-3 px-4 text-slate-600 dark:text-slate-400">
          {{ task.project.name if task.project else "Personal" }}
        </td>

        <td class="py-3 px-4">
          {% if task.status == "completed" %}
          <span class="px-2 py-1 rounded text-xs bg-green-100 text-green-700 dark:bg-green-700/20 dark:text-green-300">
            Completed
          </span>
          {% else %}
          <span class="px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-700 dark:bg-yellow-700/20 dark:text-yellow-300">
            Pending
          </span>
          {% endif %}
        </td>

        <td class="py-3 px-4 text-slate-600 dark:text-slate-400">
          {{ task.due_date.strftime("%d %b") if task.due_date else "—" }}
        </td>

        <td class="py-3 px-4 text-right flex gap-2 justify-end">

          <!-- Edit -->
          <a href="{{ url_for('dashboard.task_edit', task_id=task.id) }}"
             class="px-3 py-1 text-xs rounded bg-blue-500 text-white hover:bg-blue-600">
            Edit
          </a>

          <!-- Delete -->
          <form action="{{ url_for('dashboard.task_delete', task_id=task.id) }}" method="POST"
                onsubmit="return confirm('Delete this task?');">
            <button class="px-3 py-1 text-xs rounded bg-red-500 text-white hover:bg-red-600">
              Delete
            </button>
          </form>

        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% if not tasks %}
  <p class="p-6 text-center text-slate-500 dark:text-slate-400">
    No tasks found — create your first task!
  </p>
  {% endif %}

</div>

{% endblock %}